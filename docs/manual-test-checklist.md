# Portal 手動テストチェックリスト（Hint Mode）

このドキュメントは、自動テストでカバーできない機能の手動テスト手順を記載しています。

## 前提条件

- macOS 15.0 (Sequoia) 以降
- Xcode 16.2 以上
- Portal.app がビルド済み

## 1. ステータスバー

### 1.1 ステータスバーアイコン表示

- [ ] アプリ起動後、メニューバーにアイコンが表示される
- [ ] アクセシビリティ権限がない場合: 警告アイコン (exclamationmark.triangle) が表示される
- [ ] アクセシビリティ権限がある場合: command アイコンが表示される

### 1.2 ステータスバーメニュー

- [ ] アイコンをクリックするとメニューが表示される
- [ ] メニューに "Settings..." が表示される (Command+,)
- [ ] メニューに "Quit Portal" が表示される (Command+Q)
- [ ] アクセシビリティ権限がない場合: "Grant Accessibility Permission..." が表示される

### 1.3 メニュー項目の動作

- [ ] "Settings..." をクリックすると設定ウィンドウが開く
- [ ] "Quit Portal" をクリックするとアプリが終了する
- [ ] "Grant Accessibility Permission..." をクリックするとシステム設定が開く

## 2. Hint Mode（ホットキー）

### 2.1 起動（デフォルト: Fキー）

- [ ] アクセシビリティ権限がある状態で、ホットキー（デフォルト: 修飾キーなしの F）でHint Modeが起動する
- [ ] 起動すると、対象アプリのウィンドウ要素上にヒントラベルがオーバーレイ表示される

### 2.2 トグル動作

- [ ] Hint Modeが起動中に再度ホットキーを押すと、Hint Modeが終了する

### 2.3 終了（Escape）

- [ ] Hint Mode起動中に Escape を押すと終了する

### 2.4 入力（Backspace）

- [ ] Hint Mode起動中に文字キーを入力すると、ラベルの絞り込み表示が更新される
- [ ] Backspace で入力が1文字消える
- [ ] 入力が不一致になった場合、入力がリセットされ表示が元に戻る

## 3. Hint Mode（実行）

### 3.1 実行と自動終了

- [ ] ラベル入力が一意に確定したら対象要素が実行される（クリック/選択など）
- [ ] 実行（成功/失敗に関わらず）後にHint Modeが終了する

### 3.2 キーイベントの消費

- [ ] Hint Mode起動中に入力した文字が、対象アプリ側に入力されない（キーが食われる）

### 3.3 セレクトボックス（ポップアップ選択肢）

- [ ] セレクトボックスを開いた状態でHint Modeを起動すると、ポップアップ内の選択肢にもヒントラベルが表示される
- [ ] 選択肢のラベル入力で選択が実行され、Hint Modeが終了する

### 3.4 テーブル内のスイッチ/チェックボックス

- [ ] システム設定 > Spotlight > 検索結果 で、アプリ一覧のトグルスイッチにヒントラベルが表示される
- [ ] ヒントラベルを入力してスイッチが正しくトグルされる
- [ ] 既存の単独スイッチ（Show Related Content等）にも引き続きラベルが表示される

## 4. 表示（マルチモニタ）

- [ ] マルチモニタ環境で、各ディスプレイに適切にオーバーレイが表示される
- [ ] 各ディスプレイ上の要素に対してヒントラベルが正しい位置に出る

## 5. 権限がない場合の挙動

- [ ] アクセシビリティ権限がない状態でホットキーを押すとビープ音が鳴り、Hint Modeは起動しない
- [ ] ステータスメニューの "Grant Accessibility Permission..." から権限付与導線が確認できる

## 6. パフォーマンス（体感）

- [ ] ホットキー→オーバーレイ表示が体感で素早い
- [ ] Activity Monitor でアイドル時のCPU使用率が低い

---

## テスト記録

| 項目 | 値 |
|------|-----|
| テスト実行日 | |
| テスト実行者 | |
| macOS バージョン | |
| Portal バージョン | |
| 結果 | Pass / Fail |

## 備考
